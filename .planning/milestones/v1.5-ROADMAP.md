# Milestone v1.5: Bug Fixes & Stability

**Status:** SHIPPED 2026-01-31
**Phases:** 15
**Total Plans:** 1

## Overview

Formalized bug fixes discovered during v1.4 validation and real-world usage into a stable release. Fixed encryption library (libsodium), template dependencies, and hardened CLI commands for production use with idempotent re-runs.

## Phases

### Phase 15: Formalize Bug Fixes

**Goal**: Commit and verify all bug fixes discovered during v1.4 validation and real-world usage.
**Depends on**: Phase 14
**Plans**: 1 plan

**Requirements:** ENC-01, ENC-02, ENC-03, TPL-01, TPL-02, TPL-03, CLI-01, CLI-02, CLI-03, DOC-01

**Success criteria:**
1. `npm run build` passes with libsodium-wrappers (no tweetnacl references remain)
2. `npm test` passes all 118 unit tests
3. `npm run test:e2e` passes all 5 core e2e configs
4. `npx create-aws-project setup-aws-envs` does not throw ESM module resolution errors
5. Generated mobile projects compile and run tests with Jest 30 + Expo SDK 53
6. `setup-aws-envs` creates IAM deployment users and saves user names to config
7. `initialize-github` uses existing user from config when available, falls back to full creation

Plans:
- [x] 15-01-PLAN.md — Harden CLI error handling, verify fixes, commit v1.5 changeset

**Details:**
- Verified all 10 requirements (ENC-01/02/03, TPL-01/02/03, CLI-01/02/03, DOC-01)
- Hardened IAM operations: tag-based adoption, access key limit detection, summary table output
- Two-step flow: setup-aws-envs creates users → initialize-github reads from config
- Backward compatibility preserved for older projects without deploymentUsers in config

---

## Milestone Summary

**Decimal Phases:** None

**Key Decisions:**
- Tag-based adoption of existing IAM users (safer than blind adoption by name)
- Access key limit detection before creation (AWS max 2 per user)
- Summary table format for CLI output showing all environments at once
- Deployment user name shown instead of full ARN (cleaner UX)
- createRequire for CJS loading of libsodium-wrappers (ESM build has broken relative import)
- jest-jasmine2 for mobile tests (Jest 30 jest-circus conflicts with Expo SDK 53)
- @testing-library/react-native/extend-expect replacing deprecated jest-native

**Issues Resolved:**
- GitHub secrets encryption 422 errors (tweetnacl → libsodium)
- libsodium-wrappers ESM runtime error (createRequire CJS fallback)
- Missing @testing-library/dom peer dependency in generated web projects
- Deprecated @testing-library/jest-native in mobile projects
- Jest 30 + Expo SDK 53 test runner incompatibility
- IAM user creation in wrong CLI command (moved to setup-aws-envs)

**Issues Deferred:**
- Performance optimizations (cached npm install, parallel validation) — future enhancement
- Watch mode for template development — future enhancement
- Multi-region deployment support — future version

**Technical Debt Incurred:**
- Minor: AwsStarterConfig interface in cli.ts missing deploymentUsers field (non-breaking)
- E2E tests not executed during verification (infrastructure validated in phase 14)

---

_For current project status, see .planning/ROADMAP.md_
