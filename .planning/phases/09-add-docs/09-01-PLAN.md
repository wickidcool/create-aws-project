---
phase: 09-add-docs
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/templates/types.ts
  - src/templates/manifest.ts
  - templates/manifest.json
  - templates/root/README.md
autonomous: true

must_haves:
  truths:
    - "Generated project has a README.md in root directory"
    - "README shows project name from wizard input"
    - "README shows platform-specific sections based on platform selection"
    - "README includes AWS setup workflow reference"
  artifacts:
    - path: "templates/root/README.md"
      provides: "Template for generated project README"
      min_lines: 80
    - path: "src/templates/types.ts"
      provides: "Platform tokens for conditional sections"
      contains: "WEB: string"
    - path: "src/templates/manifest.ts"
      provides: "deriveTokenValues with platform tokens"
      contains: "WEB:"
    - path: "templates/manifest.json"
      provides: "README entry in shared files"
      contains: "root/README.md"
  key_links:
    - from: "templates/root/README.md"
      to: "src/templates/types.ts"
      via: "TokenValues interface"
      pattern: "WEB|MOBILE|API"
    - from: "src/generator/copy-file.ts"
      to: "templates/root/README.md"
      via: "textExtensions includes .md"
      pattern: "\\.md"
---

<objective>
Add README.md template for generated projects with platform-conditional sections.

Purpose: Generated projects currently have no documentation. Users need immediate guidance on project structure, available commands, and AWS setup workflow after generation.

Output: Every generated project will have a personalized README.md with sections appropriate for their platform selection.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/09-add-docs/09-RESEARCH.md

# Critical implementation files
@src/templates/types.ts
@src/templates/manifest.ts
@src/generator/replace-tokens.ts
@templates/manifest.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add platform tokens to templating system</name>
  <files>
    src/templates/types.ts
    src/templates/manifest.ts
  </files>
  <action>
Add platform-specific tokens to enable conditional README sections:

1. In `src/templates/types.ts`, add to TokenValues interface (after AUTH_MFA line):
   ```typescript
   /** Platform selection flags ('true' or 'false') */
   WEB: string;
   MOBILE: string;
   API: string;
   ```

2. In `src/templates/manifest.ts`, add to deriveTokenValues() return object (after AUTH_MFA line):
   ```typescript
   // Platform tokens for conditional documentation
   WEB: config.platforms.includes('web') ? 'true' : 'false',
   MOBILE: config.platforms.includes('mobile') ? 'true' : 'false',
   API: config.platforms.includes('api') ? 'true' : 'false',
   ```

These tokens enable {{#if WEB}}...{{/if WEB}} blocks in README.md.
  </action>
  <verify>
TypeScript compiles without errors:
```bash
cd /Users/alwick/development/projects/create-aws-starter-kit && npm run build
```
  </verify>
  <done>
TokenValues interface includes WEB, MOBILE, API string fields.
deriveTokenValues() populates these based on config.platforms array.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create README.md template with conditional sections</name>
  <files>
    templates/root/README.md
  </files>
  <action>
Create `templates/root/README.md` with the following structure (under 200 lines):

```markdown
# {{PROJECT_NAME}}

Full-stack application built with create-aws-project.

## Quick Start

\`\`\`bash
npm install
\`\`\`

{{#if WEB}}
Start the web app:
\`\`\`bash
npm run web
\`\`\`
{{/if WEB}}

{{#if MOBILE}}
Start the mobile app:
\`\`\`bash
npm run mobile
\`\`\`
{{/if MOBILE}}

{{#if API}}
Deploy to AWS:
\`\`\`bash
npm run cdk:deploy
\`\`\`
{{/if API}}

## Project Structure

\`\`\`
{{PROJECT_NAME}}/
{{#if WEB}}
├── apps/web/          # React + Vite web application
{{/if WEB}}
{{#if MOBILE}}
├── apps/mobile/       # React Native + Expo mobile app
{{/if MOBILE}}
{{#if API}}
├── apps/api/          # AWS Lambda API + CDK infrastructure
{{/if API}}
├── packages/
│   ├── common-types/  # Shared TypeScript types
│   └── api-client/    # Shared API client
└── package.json       # Root package with Nx scripts
\`\`\`

## Available Commands

| Command | Description |
|---------|-------------|
{{#if WEB}}
| \`npm run web\` | Start web development server |
| \`npm run build:web\` | Build web app for production |
{{/if WEB}}
{{#if MOBILE}}
| \`npm run mobile\` | Start Expo development server |
| \`npm run mobile:ios\` | Run on iOS simulator |
| \`npm run mobile:android\` | Run on Android emulator |
{{/if MOBILE}}
{{#if API}}
| \`npm run cdk:deploy\` | Deploy to AWS (dev environment) |
| \`npm run cdk:deploy:stage\` | Deploy to staging |
| \`npm run cdk:deploy:prod\` | Deploy to production |
| \`npm run cdk:synth\` | Synthesize CloudFormation template |
{{/if API}}
| \`npm run test\` | Run all tests |
| \`npm run lint\` | Lint all projects |

## AWS Setup

Before deploying to AWS, you need to set up your AWS environments and GitHub deployment pipeline.

### Prerequisites

- AWS CLI configured with management account credentials
- GitHub repository created for this project
- GitHub Personal Access Token with "repo" scope

### 1. Set Up AWS Environments

\`\`\`bash
npx create-aws-project setup-aws-envs
\`\`\`

This creates an AWS Organization with three environment accounts (dev, stage, prod).

### 2. Configure GitHub Deployment

For each environment:

\`\`\`bash
npx create-aws-project initialize-github dev
npx create-aws-project initialize-github stage
npx create-aws-project initialize-github prod
\`\`\`

This configures GitHub Environment secrets for automated deployments.

### 3. Deploy

Push to main to trigger your first deployment:

\`\`\`bash
git push origin main
\`\`\`

For detailed setup instructions and troubleshooting, see the [create-aws-project documentation](https://www.npmjs.com/package/create-aws-starter-kit).

## CI/CD Workflows

| Workflow | Trigger | Description |
|----------|---------|-------------|
| pull-request.yml | Any PR | Runs lint, test, and build validation |
| deploy-dev.yml | Push to main | Deploys to development environment |
| deploy-stage.yml | Manual | Deploys to staging environment |
| deploy-prod.yml | Manual | Deploys to production environment |

## Environment Variables

{{#if WEB}}
### Web App

Copy \`apps/web/.env.example\` to \`apps/web/.env.local\` and configure:

- \`VITE_API_URL\` - API Gateway endpoint URL
{{/if WEB}}

{{#if API}}
### API

Environment variables are configured in CDK stacks (\`apps/api/cdk/\`).
{{/if API}}

## Technology Stack

{{#if WEB}}
- **Web**: React 19, Vite, Chakra UI, TypeScript
{{/if WEB}}
{{#if MOBILE}}
- **Mobile**: React Native, Expo, TypeScript
{{/if MOBILE}}
{{#if API}}
- **API**: AWS Lambda, API Gateway, DynamoDB, CDK
{{/if API}}
- **Monorepo**: Nx
- **Testing**: Jest, Testing Library
- **CI/CD**: GitHub Actions

## License

ISC
```

Key design decisions:
- Conditional blocks for platform-specific sections using existing {{#if TOKEN}} syntax
- AWS setup section references CLI docs (not duplicating troubleshooting)
- Under 200 lines when all platforms selected, under 100 for single platform
- No version numbers (they go stale)
  </action>
  <verify>
File exists and has conditional blocks:
```bash
test -f /Users/alwick/development/projects/create-aws-starter-kit/templates/root/README.md && grep -c "{{#if" /Users/alwick/development/projects/create-aws-starter-kit/templates/root/README.md
```
Should return count > 10 (many conditional blocks).
  </verify>
  <done>
templates/root/README.md exists with {{PROJECT_NAME}} token and {{#if WEB/MOBILE/API}} conditional blocks.
  </done>
</task>

<task type="auto">
  <name>Task 3: Register README in manifest and test generation</name>
  <files>
    templates/manifest.json
    src/templates/manifest.ts
  </files>
  <action>
1. Add README.md to `templates/manifest.json` shared array (first entry, before package.json):
   ```json
   { "src": "root/README.md", "dest": "README.md" },
   ```

2. Add same entry to `src/templates/manifest.ts` templateManifest.shared array (first entry):
   ```typescript
   { src: 'root/README.md', dest: 'README.md' },
   ```

3. Test by generating a project and verifying README appears with correct content:
   ```bash
   cd /tmp && rm -rf test-docs-gen
   node /Users/alwick/development/projects/create-aws-starter-kit/dist/index.js test-docs-gen --platforms web,api --auth none --features github-actions --region us-east-1 --color blue
   ```

   Then verify:
   - README.md exists in generated project
   - Contains "test-docs-gen" (project name replaced)
   - Contains web commands (platform conditional worked)
   - Does NOT contain mobile commands (mobile not selected)

Note: If CLI doesn't support non-interactive mode, create a minimal test project manually or verify by reading the template token replacement logic.
  </action>
  <verify>
Verify manifest entries:
```bash
grep -q "root/README.md" /Users/alwick/development/projects/create-aws-starter-kit/templates/manifest.json && echo "manifest.json OK"
grep -q "root/README.md" /Users/alwick/development/projects/create-aws-starter-kit/src/templates/manifest.ts && echo "manifest.ts OK"
```

Build succeeds:
```bash
cd /Users/alwick/development/projects/create-aws-starter-kit && npm run build
```
  </verify>
  <done>
README.md is registered in both manifest.json and manifest.ts.
Build succeeds without errors.
Generated projects will receive personalized README.md.
  </done>
</task>

</tasks>

<verification>
After all tasks:
1. `npm run build` succeeds
2. TokenValues interface includes WEB, MOBILE, API
3. templates/root/README.md exists with conditional blocks
4. manifest.json and manifest.ts both include README entry
5. Template follows conditional block syntax from replace-tokens.ts
</verification>

<success_criteria>
- Generated projects include README.md in root directory
- README contains project name ({{PROJECT_NAME}} replaced)
- README shows only relevant platform sections based on selection
- README includes AWS setup workflow documentation
- No duplication of CLI README troubleshooting content
</success_criteria>

<output>
After completion, create `.planning/phases/09-add-docs/09-01-SUMMARY.md`
</output>
